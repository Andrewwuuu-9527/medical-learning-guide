name: Deploy to GitHub Pages

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pages: write
      id-token: write
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4 # 使用稳定的v4版本

    - name: Setup Pages
      uses: actions/configure-pages@v3 # 当前最新稳定版本

    - name: Create deployment package
      run: |
        mkdir -p ./_site
        cp -r ./src/* ./_site/
        echo "Deployment package created"

    - name: Upload artifact
      uses: actions/upload-pages-artifact@v3 # 升级至v3版本
      with:
        path: ./_site

    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4 # 升级至v4版本